<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fixed 1440-Slice Clock Pie Chart</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <canvas id="clockPieChart" width="400" height="400"></canvas>

    <script>
        const ctx = document.getElementById('clockPieChart').getContext('2d');

        // Function to convert HH:MM to minutes (0-1439)
        function timeToMinutes(time) {
            const [hours, minutes] = time.split(':').map(Number);
            return hours * 60 + minutes;
        }

        // Define activities with start and end times
        const activities = [
            { name: "Sleep", color: "#1E3A8A", start: "23:00", end: "08:00" },
            { name: "Work", color: "#EAB308", start: "08:00", end: "12:00" },
            { name: "Fog", color: "#4B5563", start: "12:00", end: "23:00" }
        ];

        // Initialize 1440 minutes with default values
        const minuteLabels = new Array(1440).fill("Unassigned");
        const minuteColors = new Array(1440).fill("#CCCCCC"); // Default color

        // Assign activities to minutes
        activities.forEach(activity => {
            let start = timeToMinutes(activity.start);
            let end = timeToMinutes(activity.end);

            // Handle cases where activity wraps around midnight
            if (end < start) {
                for (let i = start; i < 1440; i++) {
                    minuteLabels[i] = activity.name;
                    minuteColors[i] = activity.color;
                }
                for (let i = 0; i < end; i++) {
                    minuteLabels[i] = activity.name;
                    minuteColors[i] = activity.color;
                }
            } else {
                for (let i = start; i < end; i++) {
                    minuteLabels[i] = activity.name;
                    minuteColors[i] = activity.color;
                }
            }
        });

        // Aggregate minutes into larger slices to keep the chart readable
        const sliceSize = 10; // Each slice represents 10 minutes
        const data = [];
        const backgroundColors = [];
        const labels = [];

        for (let i = 0; i < 1440; i += sliceSize) {
            let label = minuteLabels[i]; // Use the label of the first minute in the slice
            data.push(sliceSize);
            labels.push(label);
            backgroundColors.push(minuteColors[i]);
        }

        // Create Chart.js Pie Chart
        new Chart(ctx, {
            type: 'pie',
            data: {
                labels: labels,
                datasets: [{
                    data: data,
                    backgroundColor: backgroundColors,
                    borderColor: '#ffffff',
                    borderWidth: 1,
                }]
            },
            options: {
                responsive: true,
                rotation: -90, // Ensure 0:00 is at the top
                circumference: 360, // Full circle
                plugins: {
                    legend: {
                        position: 'bottom'
                    }
                }
            }
        });
    </script>
</body>
</html>
